<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Pok√©mon Viewer + Firebase Auth</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        background: #f0f4f8;
        text-align: center;
        padding: 20px;
      }
      h1 {
        color: #ff4757;
      }
      input,
      button {
        padding: 8px 12px;
        margin: 5px;
        font-size: 16px;
        border-radius: 8px;
        border: 1px solid #ccc;
      }
      button {
        background: #2ed573;
        color: white;
        border: none;
        cursor: pointer;
        transition: 0.2s;
      }
      button:hover {
        background: #1eae60;
      }
      .pokemon-container {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }
      .card {
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        padding: 10px;
        transition: 0.3s;
      }
      .card:hover {
        transform: scale(1.05);
      }
      img {
        width: 150px;
        height: auto;
      }
      .name {
        font-weight: bold;
        margin-top: 5px;
      }
      .auth-box {
        margin-bottom: 20px;
        background: #fff;
        display: inline-block;
        padding: 15px;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
    </style>
  </head>

  <body>
    <h1>Pok√©mon Viewer + Firebase Auth</h1>

    <div class="auth-box">
      <h3>ƒêƒÉng k√Ω / ƒêƒÉng nh·∫≠p</h3>
      <input type="email" id="email" placeholder="Email" />
      <input type="password" id="password" placeholder="M·∫≠t kh·∫©u" />
      <button id="registerBtn">ƒêƒÉng k√Ω</button>
      <button id="loginBtn">ƒêƒÉng nh·∫≠p</button>
      <p id="authMessage"></p>
    </div>

    <div>
      <input type="number" id="startId" placeholder="Nh·∫≠p ID b·∫Øt ƒë·∫ßu" />
      <button onclick="loadPokemons()">Xem Pok√©mon</button>
    </div>

    <div id="pokemonContainer" class="pokemon-container"></div>

    <!-- Firebase SDK -->
    <script type="module">
      // Import Firebase core + Authentication
      import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
      import {
        getAuth,
        createUserWithEmailAndPassword,
        signInWithEmailAndPassword,
        onAuthStateChanged,
        signOut,
      } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-auth.js";

      // C·∫•u h√¨nh Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyAOV-TWPLY37Bhz5vnAQ-Q36RxEZc4rvJU",
        authDomain: "quanghuy-jsi2025.firebaseapp.com",
        projectId: "quanghuy-jsi2025",
        storageBucket: "quanghuy-jsi2025.firebasestorage.app",
        messagingSenderId: "139932063285",
        appId: "1:139932063285:web:6f3fda1713413d1925837c",
      };

      // Kh·ªüi t·∫°o Firebase
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      console.log("‚úÖ Firebase ƒë√£ k·∫øt n·ªëi th√†nh c√¥ng!");

      // --- AUTH LOGIC ---
      const emailInput = document.getElementById("email");
      const passwordInput = document.getElementById("password");
      const messageBox = document.getElementById("authMessage");

      document.getElementById("registerBtn").addEventListener("click", async () => {
        try {
          const userCredential = await createUserWithEmailAndPassword(
            auth,
            emailInput.value,
            passwordInput.value
          );
          messageBox.innerText = "üéâ ƒêƒÉng k√Ω th√†nh c√¥ng!";
          console.log("User registered:", userCredential.user);
        } catch (error) {
          messageBox.innerText = "‚ùå " + error.message;
        }
      });

      document.getElementById("loginBtn").addEventListener("click", async () => {
        try {
          const userCredential = await signInWithEmailAndPassword(
            auth,
            emailInput.value,
            passwordInput.value
          );
          messageBox.innerText = "‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng!";
          console.log("User logged in:", userCredential.user);
        } catch (error) {
          messageBox.innerText = "‚ùå " + error.message;
        }
      });

      onAuthStateChanged(auth, (user) => {
        if (user) {
          console.log("Ng∆∞·ªùi d√πng hi·ªán t·∫°i:", user.email);
        } else {
          console.log("Ch∆∞a c√≥ ai ƒëƒÉng nh·∫≠p");
        }
      });

      // --- POK√âMON FETCH ---
      async function loadPokemons() {
        const pokemonContainer = document.getElementById("pokemonContainer");
        pokemonContainer.innerHTML = "";
        const startId = parseInt(document.getElementById("startId").value);

        if (isNaN(startId) || startId <= 0) {
          pokemonContainer.innerHTML = "<p>‚ö†Ô∏è Vui l√≤ng nh·∫≠p ID h·ª£p l·ªá!</p>";
          return;
        }

        for (let i = startId; i < startId + 20; i++) {
          try {
            const response = await fetch(`https://pokeapi.co/api/v2/pokemon/${i}`);
            if (!response.ok) throw new Error("Kh√¥ng t√¨m th·∫•y Pok√©mon ID: " + i);
            const pokemon = await response.json();
            const name = pokemon.name.charAt(0).toUpperCase() + pokemon.name.slice(1);

            const div = document.createElement("div");
            div.className = "card";
            div.innerHTML = `
              <img src="${pokemon.sprites.front_default}" alt="${name}">
              <div class="name">${name}</div>
              <p>ID: ${pokemon.id}</p>
            `;
            pokemonContainer.appendChild(div);
          } catch (e) {
            console.warn(e.message);
          }
        }
      }

      window.loadPokemons = loadPokemons;
    </script>
  </body>
</html>
